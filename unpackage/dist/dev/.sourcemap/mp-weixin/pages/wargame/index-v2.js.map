{"version":3,"sources":["uni-app:///main.js","webpack:///D:/chess/code/new-wargame-uniapp/pages/wargame/index-v2.vue?6bf8","webpack:///D:/chess/code/new-wargame-uniapp/pages/wargame/index-v2.vue?06fb","webpack:///D:/chess/code/new-wargame-uniapp/pages/wargame/index-v2.vue?b209","webpack:///D:/chess/code/new-wargame-uniapp/pages/wargame/index-v2.vue?5d34","uni-app:///pages/wargame/index-v2.vue","webpack:///D:/chess/code/new-wargame-uniapp/pages/wargame/index-v2.vue?74bd","webpack:///D:/chess/code/new-wargame-uniapp/pages/wargame/index-v2.vue?69b6"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqS;AACrS;AAC4D;AACL;AACsC;;;AAG7F;AACgL;AAChL,gBAAgB,uLAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,mQAAM;AACR,EAAE,4QAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uQAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,kRAEN;AACP,KAAK;AACL;AACA,aAAa,sTAEN;AACP,KAAK;AACL;AACA,aAAa,6SAEN;AACP,KAAK;AACL;AACA,aAAa,yQAEN;AACP,KAAK;AACL;AACA,aAAa,uPAEN;AACP,KAAK;AACL;AACA,aAAa,gQAEN;AACP,KAAK;AACL;AACA,aAAa,8OAEN;AACP,KAAK;AACL;AACA,aAAa,8OAEN;AACP,KAAK;AACL;AACA,aAAa,kRAEN;AACP,KAAK;AACL;AACA,aAAa,wUAEN;AACP,KAAK;AACL;AACA,aAAa,wUAEN;AACP,KAAK;AACL;AACA,aAAa,oSAEN;AACP,KAAK;AACL;AACA,aAAa,6SAEN;AACP,KAAK;AACL;AACA,aAAa,oSAEN;AACP,KAAK;AACL;AACA,aAAa,yQAEN;AACP,KAAK;AACL;AACA,aAAa,gQAEN;AACP,KAAK;AACL;AACA,aAAa,+TAEN;AACP,KAAK;AACL;AACA,aAAa,wUAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACvIA;AAAA;AAAA;AAAA;AAAsqB,CAAgB,oqBAAG,EAAC,C;;;;;;;;;;;;;;;;;;eCA1rB;AAAA,2B;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAA6xC,CAAgB,mtCAAG,EAAC,C;;;;;;;;;;;ACAjzC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/wargame/index-v2.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/wargame/index-v2.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index-v2.vue?vue&type=template&id=4e433f65&scoped=true&filter-modules=eyJvbE1hcCI6eyJ0eXBlIjoicmVuZGVyanMiLCJjb250ZW50IjoiIiwic3RhcnQiOjkyMDIsImF0dHJzIjp7Im1vZHVsZSI6Im9sTWFwIiwibGFuZyI6ImpzIn0sImVuZCI6NTEzNTV9fQ%3D%3D&\"\nvar renderjs\nimport script from \"./index-v2.vue?vue&type=script&lang=js&\"\nexport * from \"./index-v2.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index-v2.vue?vue&type=style&index=0&id=4e433f65&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4e433f65\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/wargame/index-v2.vue\"\nexport default component.exports","export * from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index-v2.vue?vue&type=template&id=4e433f65&scoped=true&filter-modules=eyJvbE1hcCI6eyJ0eXBlIjoicmVuZGVyanMiLCJjb250ZW50IjoiIiwic3RhcnQiOjkyMDIsImF0dHJzIjp7Im1vZHVsZSI6Im9sTWFwIiwibGFuZyI6ImpzIn0sImVuZCI6NTEzNTV9fQ%3D%3D&\"","var components\ntry {\n  components = {\n    xinyiSteps: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/xinyi-steps/components/xinyi-steps/xinyi-steps\" */ \"@/uni_modules/xinyi-steps/components/xinyi-steps/xinyi-steps.vue\"\n      )\n    },\n    uvAvatar: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uv-avatar/components/uv-avatar/uv-avatar\" */ \"@/uni_modules/uv-avatar/components/uv-avatar/uv-avatar.vue\"\n      )\n    },\n    uvModal: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uv-modal/components/uv-modal/uv-modal\" */ \"@/uni_modules/uv-modal/components/uv-modal/uv-modal.vue\"\n      )\n    },\n    uniDrawer: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-drawer/components/uni-drawer/uni-drawer\" */ \"@/uni_modules/uni-drawer/components/uni-drawer/uni-drawer.vue\"\n      )\n    },\n    uniCard: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-card/components/uni-card/uni-card\" */ \"@/uni_modules/uni-card/components/uni-card/uni-card.vue\"\n      )\n    },\n    uniTable: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-table/components/uni-table/uni-table\" */ \"@/uni_modules/uni-table/components/uni-table/uni-table.vue\"\n      )\n    },\n    uniTr: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-table/components/uni-tr/uni-tr\" */ \"@/uni_modules/uni-table/components/uni-tr/uni-tr.vue\"\n      )\n    },\n    uniTd: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-table/components/uni-td/uni-td\" */ \"@/uni_modules/uni-table/components/uni-td/uni-td.vue\"\n      )\n    },\n    scoreTable: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/score-table/components/score-table/score-table\" */ \"@/uni_modules/score-table/components/score-table/score-table.vue\"\n      )\n    },\n    judgeTable: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/judge-table/components/judge-table/judge-table\" */ \"@/uni_modules/judge-table/components/judge-table/judge-table.vue\"\n      )\n    },\n    scoreTableFinal: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/score-table-final/components/score-table-final/score-table-final\" */ \"@/uni_modules/score-table-final/components/score-table-final/score-table-final.vue\"\n      )\n    },\n    finalSummary: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/final-summary/components/final-summary/final-summary\" */ \"@/uni_modules/final-summary/components/final-summary/final-summary.vue\"\n      )\n    },\n    uvImage: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uv-image/components/uv-image/uv-image\" */ \"@/uni_modules/uv-image/components/uv-image/uv-image.vue\"\n      )\n    },\n    uvText: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uv-text/components/uv-text/uv-text\" */ \"@/uni_modules/uv-text/components/uv-text/uv-text.vue\"\n      )\n    },\n    ruleTable: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/rule-table/components/rule-table/rule-table\" */ \"@/uni_modules/rule-table/components/rule-table/rule-table.vue\"\n      )\n    },\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    },\n    xinyiDice: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/xinyi-dice/components/xinyi-dice/xinyi-dice\" */ \"@/uni_modules/xinyi-dice/components/xinyi-dice/xinyi-dice.vue\"\n      )\n    },\n    blowEffectTable: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/blow-effect-table/components/blow-effect-table/blow-effect-table\" */ \"@/uni_modules/blow-effect-table/components/blow-effect-table/blow-effect-table.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      _vm.attackConfirm = false\n    }\n    _vm.e1 = function ($event) {\n      _vm.scoutConfirm = false\n    }\n    _vm.e2 = function ($event) {\n      _vm.reactanceConfirm = false\n    }\n    _vm.e3 = function ($event) {\n      _vm.communicationConfirm = false\n    }\n    _vm.e4 = function ($event) {\n      _vm.moveConfirm = false\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index-v2.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index-v2.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"xinyi-content\">\n\t\t<view class=\"rightBtn\" v-if=\"initType != 'watch'\">\n\t\t\t<view class=\"btnView\" @click=\"showActionDescFunc\">记录明细</view>\n\t\t\t<view class=\"btnView\" @click=\"getRealTimeScore\">实时得分</view>\n\t\t\t<view class=\"btnView\" @click=\"getJudgeTable\">指令录入</view>\n\t\t\t<view class=\"btnView\" @click=\"getJudgeResult\">裁决结果</view>\n\t\t\t<view v-if=\"userType == 'admin'\" class=\"btnView\" @click=\"getTableScoreFinal\">推演得分</view>\n\t\t\t<view class=\"btnView\" @click=\"getFinalSummary\">推演汇总</view>\n\t\t</view>\n\t\t<view class=\"middleBtn\">\n\t\t\t<view class=\"btnView\" v-if=\"isMove\" @click=\"moveStop\">移动结束</view>\n\t\t\t<view class=\"btnView\" v-if=\"nextStageFlag\" @click=\"nextStage\">{{ nextBtnText }}</view>\n\t\t</view>\n\t\t<view class=\"top__view\">\n\t\t\t<xinyi-steps\n\t\t\t\t:options=\"stageOptions\"\n\t\t\t\t:active=\"stageActive\"\n\t\t\t\tarrowRight\n\t\t\t\t:canClick=\"true\"\n\t\t\t\t:clickType=\"'stage'\"\n\t\t\t\t:statusDesc=\"statusDesc\"\n\t\t\t\t:isAdmin=\"userType == 'admin'\"\n\t\t\t\t:statusIndex=\"statusIndex\"\n\t\t\t></xinyi-steps>\n\t\t\t<view class=\"dice-toolbar__veiw\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"stage-over__btn\"\n\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\tv-if=\"game.nowRound == 0 && game.isDeplaoy && userType == 'user'\"\n\t\t\t\t\t@click=\"endDeployFunc()\"\n\t\t\t\t>\n\t\t\t\t\t结束部署\n\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"stage-over__btn\"\n\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\tv-if=\"userType == 'user' && game.nowRound != 0 && userStageNotSubmit\"\n\t\t\t\t\t@click=\"endRoundFunc()\"\n\t\t\t\t>\n\t\t\t\t\t提交\n\t\t\t\t</button>\n\t\t\t\t<button class=\"stage-over__btn\" type=\"primary\" v-if=\"userType == 'judge' && roundEnd\" @click=\"judge()\">\n\t\t\t\t\t裁决\n\t\t\t\t</button>\n\t\t\t</view>\n\t\t\t<view class=\"avatar-view\">\n\t\t\t\t<uv-avatar :text=\"avatarText\" size=\"60\" fontSize=\"20\" bg-color=\"#7f7f00\" color=\"#ffffff\"></uv-avatar>\n\t\t\t\t<view>{{ avatarDesc }}</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<uv-modal\n\t\t\t:showCancelButton=\"true\"\n\t\t\tref=\"attackConfirm\"\n\t\t\t@cancel=\"attackConfirm = false\"\n\t\t\t@confirm=\"attackPoint()\"\n\t\t\ttitle=\"确认\"\n\t\t\tcontent=\"是否攻击该位置\"\n\t\t\twidth=\"200rpx\"\n\t\t></uv-modal>\n\t\t<uv-modal\n\t\t\t:showCancelButton=\"true\"\n\t\t\tref=\"scoutConfirm\"\n\t\t\t@cancel=\"scoutConfirm = false\"\n\t\t\t@confirm=\"scoutPoint()\"\n\t\t\ttitle=\"确认\"\n\t\t\tcontent=\"是否侦察该位置\"\n\t\t\twidth=\"200rpx\"\n\t\t></uv-modal>\n\t\t<uv-modal\n\t\t\t:showCancelButton=\"true\"\n\t\t\tref=\"reactanceConfirm\"\n\t\t\t@cancel=\"reactanceConfirm = false\"\n\t\t\t@confirm=\"reactancePoint()\"\n\t\t\ttitle=\"确认\"\n\t\t\tcontent=\"是否干扰该位置\"\n\t\t\twidth=\"200rpx\"\n\t\t></uv-modal>\n\n\t\t<uv-modal\n\t\t\t:showCancelButton=\"true\"\n\t\t\tref=\"communicationConfirm\"\n\t\t\t@cancel=\"communicationConfirm = false\"\n\t\t\t@confirm=\"communicationPoint()\"\n\t\t\ttitle=\"确认\"\n\t\t\tcontent=\"是否与此点位进行通信？\"\n\t\t\twidth=\"200rpx\"\n\t\t></uv-modal>\n\t\t<uv-modal\n\t\t\t:showCancelButton=\"true\"\n\t\t\tref=\"moveConfirm\"\n\t\t\t@cancel=\"moveConfirm = false\"\n\t\t\t@confirm=\"movePoint()\"\n\t\t\ttitle=\"确认\"\n\t\t\twidth=\"200rpx\"\n\t\t\tcontent=\"是否移动到该位置\"\n\t\t></uv-modal>\n\t\t<view class=\"foot-view\">\n\t\t\t<xinyi-steps\n\t\t\t\t:options=\"roundOptions\"\n\t\t\t\t:active=\"roundActive\"\n\t\t\t\t:canClick=\"true\"\n\t\t\t\t:clickType=\"'round'\"\n\t\t\t\tarrowRight\n\t\t\t\t:campData=\"campList\"\n\t\t\t\t@setScore=\"scoreTableShow\"\n\t\t\t\t:initType=\"initType\"\n\t\t\t></xinyi-steps>\n\t\t</view>\n\t\t<uni-drawer ref=\"showActionDesc\" mode=\"right\" :width=\"400\">\n\t\t\t<view class=\"scroll-view\" style=\"padding-right: 30px\">\n\t\t\t\t<scroll-view class=\"scroll-view-box\" scroll-y=\"true\" style=\"height: 80vh\">\n\t\t\t\t\t<uni-card v-for=\"(item, index) in game.actionDescList\" :key=\"index\">\n\t\t\t\t\t\t<view @click=\"cjResult(index)\" v-html=\"item\"></view>\n\t\t\t\t\t</uni-card>\n\t\t\t\t</scroll-view>\n\t\t\t</view>\n\t\t</uni-drawer>\n\t\t<uni-drawer ref=\"showRealTimeScore\" mode=\"right\" :width=\"400\">\n\t\t\t<view class=\"scroll-view\" style=\"padding-right: 30px\">\n\t\t\t\t<uni-table border>\n\t\t\t\t\t<uni-tr class=\"rowTitle\">\n\t\t\t\t\t\t<uni-td align=\"center\">{{ realTimeScore.firstCampName }}</uni-td>\n\t\t\t\t\t\t<uni-td align=\"center\">阵营</uni-td>\n\t\t\t\t\t\t<uni-td align=\"center\">{{ realTimeScore.secondCampName }}</uni-td>\n\t\t\t\t\t</uni-tr>\n\t\t\t\t\t<uni-tr class=\"rowTitle\">\n\t\t\t\t\t\t<uni-td align=\"center\">{{ realTimeScore.firstScoretype1 }}</uni-td>\n\t\t\t\t\t\t<uni-td align=\"center\">指挥口令规范性</uni-td>\n\t\t\t\t\t\t<uni-td align=\"center\">{{ realTimeScore.secondScoretype1 }}</uni-td>\n\t\t\t\t\t</uni-tr>\n\t\t\t\t\t<uni-tr class=\"rowTitle\">\n\t\t\t\t\t\t<uni-td align=\"center\">{{ realTimeScore.firstScoretype2 }}</uni-td>\n\t\t\t\t\t\t<uni-td align=\"center\">指挥要素完备性</uni-td>\n\t\t\t\t\t\t<uni-td align=\"center\">{{ realTimeScore.secondScoretype2 }}</uni-td>\n\t\t\t\t\t</uni-tr>\n\t\t\t\t\t<uni-tr class=\"rowTitle\">\n\t\t\t\t\t\t<uni-td align=\"center\">{{ realTimeScore.firstScoretype3 }}</uni-td>\n\t\t\t\t\t\t<uni-td align=\"center\">打击效果</uni-td>\n\t\t\t\t\t\t<uni-td align=\"center\">{{ realTimeScore.secondScoretype3 }}</uni-td>\n\t\t\t\t\t</uni-tr>\n\t\t\t\t\t<uni-tr class=\"rowTitle\">\n\t\t\t\t\t\t<uni-td align=\"center\">{{ realTimeScore.firstScoretypeTotal }}</uni-td>\n\t\t\t\t\t\t<uni-td align=\"center\">总分</uni-td>\n\t\t\t\t\t\t<uni-td align=\"center\">{{ realTimeScore.secondScoretypeTotal }}</uni-td>\n\t\t\t\t\t</uni-tr>\n\t\t\t\t</uni-table>\n\t\t\t</view>\n\t\t</uni-drawer>\n\t\t<score-table\n\t\t\tref=\"scoreTable\"\n\t\t\t:data=\"campListItem\"\n\t\t\t:scoreList=\"scoreList\"\n\t\t\t@submitScore=\"submitScore\"\n\t\t></score-table>\n\t\t<judge-table\n\t\t\tref=\"judgeTable\"\n\t\t\t:showInfo=\"judgeTableShowInfo\"\n\t\t\t:stageOptions=\"stageOptions\"\n\t\t\t@judgeComplete=\"judgeComplete\"\n\t\t></judge-table>\n\t\t<score-table-final\n\t\t\tref=\"scoreTableFinal\"\n\t\t\t:scoreList=\"finalScoreList\"\n\t\t\t:data=\"finalData\"\n\t\t\t@submitScore=\"submitScoreFinal\"\n\t\t></score-table-final>\n\t\t<final-summary\n\t\t\tref=\"finalSummary\"\n\t\t\t:dataArray=\"summaryScoreData\"\n\t\t\t:round=\"chartRound\"\n\t\t\t:campData=\"campList\"\n\t\t></final-summary>\n\t\t<uv-modal :showCancelButton=\"false\" :showConfirmButton=\"false\" title=\"棋子选着\" ref=\"showSelPiece\">\n\t\t\t<view>\n\t\t\t\t<div style=\"display: flex; flex-wrap: wrap; justify-content: flex-start\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"!item.isAdd && item.chessPiecesCampId == campId\"\n\t\t\t\t\t\t@click=\"selPiece(item)\"\n\t\t\t\t\t\tv-for=\"(item, index) in game.userPiece\"\n\t\t\t\t\t\tstyle=\"width: 77upx; height: 77upx\"\n\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<uv-image\n\t\t\t\t\t\t\tstyle=\"margin-left: 11upx\"\n\t\t\t\t\t\t\t:src=\"item.chessPiecesCover\"\n\t\t\t\t\t\t\twidth=\"55upx\"\n\t\t\t\t\t\t\theight=\"55upx\"\n\t\t\t\t\t\t></uv-image>\n\t\t\t\t\t\t<div style=\"text-align: center\">{{ item.chessPiecesName }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</view>\n\t\t</uv-modal>\n\t\t<view\n\t\t\tv-if=\"showChessButtonInfo.visible\"\n\t\t\t:style=\"{ left: showChessButtonInfo.left + 'px', top: showChessButtonInfo.top + 'px', zIndex: 1001 }\"\n\t\t\tclass=\"newcontextmenu\"\n\t\t\tname=\"newcontextmenu\"\n\t\t>\n\t\t\t<view class=\"score-btn-view\">\n\t\t\t\t<!-- <uv-text\n\t\t\t\t\tprefixIcon=\"empty-history\"\n\t\t\t\t\ticonStyle=\"font-size: 19px\"\n\t\t\t\t\t:text=\"'攻击'\"\n\t\t\t\t\tcolor=\"#ffffff\"\n\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t:iconStyle=\"{ color: '#ffffff', size: 18 }\"\n\t\t\t\t\t@click=\"attack()\"\n\t\t\t\t></uv-text> -->\n\t\t\t\t<uv-text\n\t\t\t\t\tprefixIcon=\"empty-history\"\n\t\t\t\t\ticonStyle=\"font-size: 19px\"\n\t\t\t\t\t:text=\"'机动'\"\n\t\t\t\t\tcolor=\"#ffffff\"\n\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t:iconStyle=\"{ color: '#ffffff', size: 18 }\"\n\t\t\t\t\t@click=\"move()\"\n\t\t\t\t></uv-text>\n\t\t\t\t<uv-text\n\t\t\t\t\tprefixIcon=\"empty-history\"\n\t\t\t\t\ticonStyle=\"font-size: 19px\"\n\t\t\t\t\t:text=\"'侦察'\"\n\t\t\t\t\tcolor=\"#ffffff\"\n\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t:iconStyle=\"{ color: '#ffffff', size: 18 }\"\n\t\t\t\t\t@click=\"scout()\"\n\t\t\t\t></uv-text>\n\t\t\t\t<uv-text\n\t\t\t\t\tprefixIcon=\"empty-history\"\n\t\t\t\t\ticonStyle=\"font-size: 19px\"\n\t\t\t\t\t:text=\"'通信'\"\n\t\t\t\t\tcolor=\"#ffffff\"\n\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t:iconStyle=\"{ color: '#ffffff', size: 18 }\"\n\t\t\t\t\t@click=\"communication()\"\n\t\t\t\t></uv-text>\n\t\t\t\t<uv-text\n\t\t\t\t\tprefixIcon=\"empty-history\"\n\t\t\t\t\ticonStyle=\"font-size: 19px\"\n\t\t\t\t\t:text=\"'打击'\"\n\t\t\t\t\tcolor=\"#ffffff\"\n\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t:iconStyle=\"{ color: '#ffffff', size: 18 }\"\n\t\t\t\t\t@click=\"attack()\"\n\t\t\t\t></uv-text>\n\t\t\t\t<uv-text\n\t\t\t\t\tprefixIcon=\"empty-history\"\n\t\t\t\t\ticonStyle=\"font-size: 19px\"\n\t\t\t\t\t:text=\"'干扰'\"\n\t\t\t\t\tcolor=\"#ffffff\"\n\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t:iconStyle=\"{ color: '#ffffff', size: 18 }\"\n\t\t\t\t\t@click=\"reactance()\"\n\t\t\t\t></uv-text>\n\t\t\t</view>\n\t\t</view>\n\t\t<view\n\t\t\tv-if=\"showChessListInfo.visible\"\n\t\t\t:style=\"{ left: showChessListInfo.left + 'px', top: showChessListInfo.top + 'px', width: '200px' }\"\n\t\t\tclass=\"newcontextmenu\"\n\t\t\tname=\"newcontextmenu\"\n\t\t>\n\t\t\t<view class=\"score-btn-view\">\n\t\t\t\t<view\n\t\t\t\t\tclass=\"chess-view\"\n\t\t\t\t\tv-for=\"(item, index) in pointChessList\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t@click=\"showChessAction($event, item)\"\n\t\t\t\t>\n\t\t\t\t\t{{ item.chessPiecesName + '-' + item.chessPiecesNumber }}\n\t\t\t\t</view>\n\t\t\t\t<!-- <uv-text\n\t\t\t\t\tv-for=\"(item, index) in pointChessList\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\tprefixIcon=\"empty-history\"\n\t\t\t\t\t:text=\"item.chessPiecesName + '-' + item.chessPiecesNumber\"\n\t\t\t\t\tcolor=\"#ffffff\"\n\t\t\t\t\t:size=\"18\"\n\t\t\t\t\ticonStyle=\"28\"\n\t\t\t\t\t@click=\"showChessAction($event, item)\"\n\t\t\t\t></uv-text> -->\n\t\t\t</view>\n\t\t</view>\n\t\t<rule-table ref=\"popupRule\" :dataArray=\"ruleArray\"></rule-table>\n\t\t<uni-popup ref=\"popup\" :isMaskClick=\"false\" maskBackgroundColor=\"rgba(0,0,0,0.2)\">\n\t\t\t<view class=\"dice__veiw\">\n\t\t\t\t<xinyi-dice v-for=\"(item, index) in diceCount\" :key=\"index\" :ref=\"`dice${index}`\"></xinyi-dice>\n\t\t\t</view>\n\t\t</uni-popup>\n\t\t<blow-effect-table\n\t\t\tref=\"blowEffectTable\"\n\t\t\t:dataArray=\"blowEffectList\"\n\t\t\t@maskClick=\"blowEffectMaskClick\"\n\t\t></blow-effect-table>\n\t\t<!-- <judge-reactance-table ref=\"judgeReactanceTable\"></judge-reactance-table> -->\n\t\t<!-- <judge-disturb-table ref=\"judgeReactanceTable\"></judge-disturb-table> -->\n\t\t<!-- <judge-command-control-table ref=\"judgeCommandControlTable\"></judge-command-control-table> -->\n\t\t<view id=\"map\"></view>\n\t</view>\n</template>\n\n<script module=\"olMap\" lang=\"renderjs\">\nlet vector;\nimport 'ol/ol.css';\nimport 'ol-ext/dist/ol-ext.css';\nimport 'ol-games/dist/ol-games.css';\nimport { Map, View, Collection } from 'ol';\nimport Draw from 'ol/interaction/Draw.js';\nimport HexGrid from 'ol-ext/render/HexGrid.js';\nimport FlowLine from 'ol-ext/style/FlowLine.js';\nimport HexMap from 'ol-games/source/HexMap.js';\nimport Feature from 'ol/Feature.js';\nimport { Circle as CircleStyle, Fill, Stroke, Style } from 'ol/style.js';\nimport { OSM, Vector as VectorSource, StadiaMaps as StadiaMapsSource } from 'ol/source.js';\nimport {\n\tLayer,\n\tTile as TileLayer,\n\tVector as VectorLayer,\n\tVectorImage as VectorImageLayer,\n\tImage as ImageLayer\n} from 'ol/layer.js';\nimport { defaults as defaultControls } from 'ol/control';\nimport Projection from 'ol/proj/Projection.js';\nimport Static from 'ol/source/ImageStatic.js';\nimport Overlay from 'ol/Overlay.js';\nimport Polygon from 'ol/geom/Polygon.js';\nimport Point from 'ol/geom/Point.js';\nimport LineString from 'ol/geom/LineString.js';\nimport Icon from 'ol/style/Icon.js';\nimport WebGLVectorLayerRenderer from 'ol/renderer/webgl/VectorLayer.js';\nimport { getOssById } from '@/api/system.js';\nimport {\n\tgetMapCoordinate,\n\tqueryGameStatus,\n\tqueryChessRound,\n\tqueryPrompt,\n\tqueryVerdictResult,\n\tqueryActionEffect,\n\tisOwnRound,\n\tqueryAllChessPiecesInfo,\n\tendDeploy,\n\tchessPiecesAction,\n\tdeployChessPieces,\n\tendRound,\n\tchessPiecesActionNew,\n\tgetRuleList,\n\tgetBlowEffectList,\n\tchessPiecesActionContinue,\n\tsubmitScore,\n\tqueryScoreList,\n\tgetRealTimeScore,\n\tgetSummaryScore,\n\tgetRoundStatus,\n\tjudge,\n\tgetMapChessImage,\n\tnextStage\n} from '../../api/verdictRecord.js';\nimport { sendMsg } from '@/api/websocket.js';\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tmapInfo: {\n\t\t\t\trow: 99,\n\t\t\t\tcol: 130\n\t\t\t},\n\t\t\tcoordinateMap: {},\n\t\t\timageArray: ['village', 'wood', 'bridge', 'city', 'shrub'],\n\t\t\timageMap: undefined,\n\t\t\tstatusImageArray:[\"ATTACK_MID\",\"ATTACK_MODERATE\",\"ATTACK_SEVERE\",\"REACTANCE_MID\",\"REACTANCE_MODERATE\",\"REACTANCE_SEVERE\",\"SCOUT_CONFIRM\",\"SCOUT_FIND\",\"SCOUT_RECOGNITION\"],\n\t\t\tverdictRecordId: '',\n\t\t\tcampId: '',\n\t\t\tuser: {},\n\t\t\tgame: {\n\t\t\t\tstatus: 0,\n\t\t\t\tchessRound: 1,\n\t\t\t\tnowRound: 0,\n\t\t\t\tbaseRound: 0,\n\t\t\t\tuserPiece: '',\n\t\t\t\tisDeplaoy: true,\n\t\t\t\tisOwn: false,\n\t\t\t\tshowSettlement: false,\n\t\t\t\tsettlement: '',\n\t\t\t\tshowResult: false,\n\t\t\t\tresult: 0,\n\t\t\t\tresultStr: '',\n\t\t\t\tallRound: 0,\n\t\t\t\troundPeriod: '',\n\t\t\t\troundDesc: '',\n\t\t\t\tactionDescList: []\n\t\t\t},\n\t\t\troundActive: 0,\n\t\t\tstageActive: 0,\n\t\t\tuserType: '',\n\t\t\tisAdmin: false,\n\t\t\tchessRoundLimit: 0,\n\t\t\tcampList: [],\n\t\t\tavatarText: '',\n\t\t\tavatarDesc: '',\n\t\t\troundOptions: [],\n\t\t\tstageOptions: [],\n\t\t\thistoryList: [],\n\t\t\troundStatusList: [],\n\t\t\tselectIndex: [],\n\t\t\tselectTargetIndex: [],\n\t\t\tstatusDesc: '',\n\t\t\troundEnd: false,\n\t\t\tuserStageNotSubmit: false,\n\t\t\tstatusIndex: -1,\n\t\t\tjudgeTableShowInfo: {},\n\t\t\trealTimeScore: {\n\t\t\t\tfirstCampName: '',\n\t\t\t\tfirstScoretype1: 0,\n\t\t\t\tfirstScoretype2: 0,\n\t\t\t\tfirstScoretype3: 0,\n\t\t\t\tfirstScoretypeTotal: 0,\n\t\t\t\tsecondCampName: '',\n\t\t\t\tsecondScoretype1: 0,\n\t\t\t\tsecondScoretype2: 0,\n\t\t\t\tsecondScoretype3: 0,\n\t\t\t\tsecondScoretypeTotal: 0\n\t\t\t},\n\t\t\tshowScoreButtonInfo: {\n\t\t\t\tvisible: false,\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0\n\t\t\t},\n\t\t\tcampListItem: {},\n\t\t\tscoreList: [],\n\t\t\tsummaryDataArray: [],\n\t\t\tfinalData: [],\n\t\t\tfinalScoreList: [],\n\t\t\tsummaryScoreData: [],\n\t\t\tchartRound: 0,\n\t\t\tselCellInfo: {},\n\t\t\ttargetCellInfo: {},\n\t\t\tmapChessArray: [],\n\t\t\tpointOffset: [],\n\t\t\thex: {},\n\t\t\tmapChessMap: {},\n\t\t\tmapChessImageMap: {},\n\t\t\tshowChessButtonInfo: {\n\t\t\t\tvisible: false,\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0\n\t\t\t},\n\t\t\tshowChessListInfo: {\n\t\t\t\tvisible: false,\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0\n\t\t\t},\n\t\t\tpointChessList: [],\n\t\t\truleArray: [],\n\t\t\tdiceCount: 2,\n\t\t\tblowEffectList: [],\n\t\t\tshowActionDescFlag: false,\n\t\t\tshowRealTimeScoreFlag: false,\n\t\t\tstageStatusActive: 0,\n\t\t\tchessMoveArray: [],\n\t\t\tisMove: false,\n\t\t\tisAttack: false,\n\t\t\tisScout: false,\n\t\t\tisReactance:false,\n\t\t\tnextStageFlag: false,\n\t\t\tscoutConfirm: false,\n\t\t\treactanceConfirm:false,\n\t\t\tisCommunication: false,\n\t\t\tcommunicationConfirm: false,\n\t\t\tflowLineArr: [], // 画箭头存储点集合\n\t\t\tnextBtnText:\"下一回合\",\n\t\t\tinitType:\"\"\n\t\t};\n\t},\n\tmounted() {\n\t\t// this.$refs.judgeCommandControlTable.open()\n\t},\n\tonLoad(res) {\n\t\tthis.onMessage();\n\t\tthis.user = uni.getStorageSync('user');\n\t\tthis.verdictRecordId = res.verdictRecordId;\n\t\tthis.campId = res.campId;\n\t\tthis.initType = res.type;\n\t\t// this.queryAllFunc();\n\t\t// this.initChessRound();\n\t\t// setTimeout(() => {\n\t\t// \tthis.queryUsChessPiecesInfoFunc();\n\t\t// }, 2121);\n\t\t// 注册websocket监听;\n\t\tthis.init();\n\t},\n\tmethods: {\n\t\tasync init() {\n\t\t\tuni.showLoading({\n\t\t\t\ttitle:\"地图数据加载中...\"\n\t\t\t})\n\t\t\tlet data = {\n\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t};\n\t\t\tlet res = await getMapCoordinate(data);\n\t\t\tthis.coordinateMap = res.data.data;\n\t\t\tlet chessIamgeData = {\n\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t};\n\t\t\tlet chessImageRes = await getMapChessImage(chessIamgeData);\n\t\t\tthis.mapChessImageMap = chessImageRes.data.data;\n\t\t\tconsole.log('this.mapChessImageMap: ',this.mapChessImageMap);\n\t\t\tthis.initImage();\n\t\t},\n\t\t// websocket 接收信息\n\t\tonMessage() {\n\t\t\tuni.$on('onMessage', (res) => {\n\t\t\t\tlet jsonRes = JSON.parse(res.data);\n\t\t\t\tlet action = jsonRes.action;\n\t\t\t\tswitch (action) {\n\t\t\t\t\tcase 'shakeDice':\n\t\t\t\t\t\tthis.$refs.popupRule.close();\n\t\t\t\t\t\tlet diceArr = jsonRes.data;\n\t\t\t\t\t\tthis.shakeDice(diceArr);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'lookUpTable':\n\t\t\t\t\t\tthis.getRuleList();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'colseTable':\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'takeAction':\n\t\t\t\t\t\tconsole.log(\"takeAction:来了\");\n\t\t\t\t\t\tthis.queryAllFunc();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'endRound':\n\t\t\t\t\t\t//更新管理员看到的提交状态\n\t\t\t\t\t\tthis.getRoundStatus();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'judge':\n\t\t\t\t\t\t//裁决结果展示\n\t\t\t\t\t\tlet judgeData = jsonRes.data;\n\t\t\t\t\t\tthis.judgeShow(judgeData);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'refresh':\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'drawRoad':\n\t\t\t\t\t\tlet road = jsonRes.data;\n\t\t\t\t\t\tthis.drawRoad(road);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'clearRoad':\n\t\t\t\t\t\tvector.getSource().clear();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tasync initImage() {\n\t\t\tlet that = this;\n\t\t\tthat.imageMap = new Map();\n\t\t\tfor (name of that.imageArray) {\n\t\t\t\tlet src = '/static/image/terrain/' + name + '.png';\n\t\t\t\tawait that.loadImage(src).then(function (img) {\n\t\t\t\t\tthat.imageMap.set(name, img);\n\t\t\t\t});\n\t\t\t}\n\t\t\tfor (var key in this.mapChessImageMap) {\n\t\t\t\tlet value = this.mapChessImageMap[key];\n\t\t\t\tconsole.log('value: ',value);\n\t\t\t\tlet oss = await getOssById(value);\n\t\t\t\tconsole.log('oss: ',oss.data.data.fileName);\n\t\t\t\tlet coverUrl = this.baseOssIpPort + oss.data.data.fileName;\n\t\t\t\tawait that.loadImage(coverUrl).then(function (img) {\n\t\t\t\t\tthat.imageMap.set(key, img);\n\t\t\t\t});\n\t\t\t}\n\t\t\tfor (name of that.statusImageArray) {\n\t\t\t\tlet src = '/static/image/status/' + name + '.png';\n\t\t\t\tawait that.loadImage(src).then(function (img) {\n\t\t\t\t\tthat.imageMap.set(name, img);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthat.initMap();\n\t\t},\n\t\tloadImage(src) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tconsole.log('src: ',src);\n\t\t\t\tvar img = new Image();\n\t\t\t\timg.src = src; // 设置图片的src，开始加载图片\n\t\t\t\timg.onload = function () {\n\t\t\t\t\tresolve(img); // 图片加载完成，将img对象传递给resolve\n\t\t\t\t};\n\t\t\t\timg.onerror = function () {\n\t\t\t\t\treject(new Error('Image load failed')); // 图片加载失败，reject带上错误信息\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\tinitMap() {\n\t\t\tlet that = this;\n\t\t\t// Layers\n\t\t\tvar layers = [\n\t\t\t\t// new TileLayer({ preload: Infinity, source: new OSM() })\n\t\t\t];\n\t\t\t// Popup\n\t\t\t// The map\n\t\t\tvar map = new Map({\n\t\t\t\ttarget: 'map',\n\t\t\t\tview: new View({\n\t\t\t\t\tminZoom: 13,\n\t\t\t\t\tmaxZoom: 17,\n\t\t\t\t\tzoom: 15,\n\t\t\t\t\tcenter: [13240200, 3767000],\n\t\t\t\t\tenableRotation: false\n\t\t\t\t}),\n\t\t\t\tlayers: layers,\n\t\t\t\tcontrols: defaultControls({\n\t\t\t\t\tzoom: false,\n\t\t\t\t\trotate: false,\n\t\t\t\t\tattribution: false\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.queryAllFunc();\n\t\t\t// var grid = new HexGrid({ size: 4000, origin: map.getView().getCenter(), row: 39, col: 54 });\n\t\t\tvar grid = new HexGrid({\n\t\t\t\tsize: 200,\n\t\t\t\torigin: map.getView().getCenter(),\n\t\t\t\trow: this.mapInfo.row,\n\t\t\t\tcol: this.mapInfo.col,\n\t\t\t\tcoordinateMap: this.coordinateMap,\n\t\t\t\timageMap: this.imageMap\n\t\t\t});\n\t\t\tvar hex = new HexMap({ hexGrid: grid });\n\t\t\tthis.hex = hex;\n\t\t\tmap.addLayer(new ImageLayer({ source: hex }));\n\n\t\t\tvar text = false;\n\t\t\t// hex.set('text', text);\n\t\t\thex.set('text', 'offset'); // axial cube offset\n\t\t\thex.showCoordiantes('offset');\n\t\t\t// grid.setLayout('flat');\n\t\t\t// grid.setSize($(4000);\n\n\t\t\tvar flowStyle = new FlowLine({\n\t\t\t\tcolor: 'red',\n\t\t\t\tcolor2: 'red',\n\t\t\t\twidth: 8,\n\t\t\t\twidth2: 8,\n\t\t\t\t_acolor: 'red',\n\t\t\t\tarrow: 1\n\t\t\t});\n\t\t\tfunction getStyle(feature, res) {\n\t\t\t\t/* ol < 7 need a style to make the feature selectable\n\t\t\t\treturn [ defaultStyle, flowStyle ];\n\t\t\t\t*/\n\t\t\t\treturn flowStyle;\n\t\t\t}\n\t\t\t vector = new VectorImageLayer({\n\t\t\t\tsource: new VectorSource({ features: new Collection() }),\n\t\t\t\tstyle: getStyle\n\t\t\t});\n\t\t\tmap.addLayer(vector);\n\n\t\t\t// Styles\n\t\t\tvar greenStyle = new Style({\n\t\t\t\tfill: new Fill({ color: 'rgba(0,255,0,0.2)' }),\n\t\t\t\tstroke: new Stroke({ color: 'green', width: 1.25 })\n\t\t\t});\n\t\t\tvar blueStyle = new Style({\n\t\t\t\tfill: new Fill({ color: 'rgba(0,0,255,0.2)' }),\n\t\t\t\tstroke: new Stroke({ color: 'blue', width: 1.25 })\n\t\t\t});\n\t\t\tvar redStyle = new Style({\n\t\t\t\tfill: new Fill({ color: 'rgba(255,0,0,0.2)' }),\n\t\t\t\tstroke: new Stroke({ color: 'red', width: 1.25 })\n\t\t\t});\n\n\t\t\tvar current = [];\n\t\t\tvar start = false;\n\n\t\t\tmap.on(['click'], function (e) {\n\t\t\t\t// hex.drawArrow([-5,1],[-4,0])\n\t\t\t\tthat.showChessListInfo.visible = false;\n\t\t\t\tthat.showChessButtonInfo.visible = false;\n\t\t\t\tif (that.userType != 'user') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet ehex = grid.coord2hex(e.coordinate);\n\t\t\t\tvar h = grid.hex2offset(ehex);\n\t\t\t\tif (that.game.nowRound == 0) {\n\t\t\t\t\t//TODO 判断这个格子里有没有棋子\n\t\t\t\t\tthat.pointOffset = h;\n\t\t\t\t\tthat.$refs.showSelPiece.open();\n\t\t\t\t} else {\n\t\t\t\t\tif (that.isMove) {\n\t\t\t\t\t\t//棋子移动\n\t\t\t\t\t\t// that.chessMove(h);\n\t\t\t\t\t\tthat.targetCellInfo = {\n\t\t\t\t\t\t\toffset: h[0] + ',' + h[1],\n\t\t\t\t\t\t\tcoordinate: hex.hexToPointNumber(h[1], h[0], that.mapInfo.row, that.mapInfo.col)\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (that.flowLineArr.length == 0) {\n\t\t\t\t\t\t\tlet first = grid.hex2coord(grid.offset2hex(that.selCellInfo.offset.split(',')));\n\t\t\t\t\t\t\tthat.flowLineArr.push(first);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// draw lines\n\t\t\t\t\t\tvar line_hex = grid.coord2hex(e.coordinate);\n\t\t\t\t\t\tlet cc = grid.hex2coord(line_hex);\n\t\t\t\t\t\tif (that.flowLineArr.toString().indexOf(cc.toString()) < 0) {\n\t\t\t\t\t\t\tthat.flowLineArr.push(cc);\n\t\t\t\t\t\t\tvar feature= vector.getSource().getFeatureById(that.selCellInfo.chessPiecesNumber)\n\t\t\t\t\t\t\tif(feature){\n\t\t\t\t\t\t\t\tvector.getSource().removeFeature(feature);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// vector.getSource().clear();\n\t\t\t\t\t\t\tvar l = new Feature({\n\t\t\t\t\t\t\t\tgeometry: new LineString(that.flowLineArr),\n\t\t\t\t\t\t\t\tstyle: getStyle,\n\t\t\t\t\t\t\t\ttype: 'LineString'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tl.setId(that.selCellInfo.chessPiecesNumber)\n\t\t\t\t\t\t\tvector.getSource().addFeature(l);\n\t\t\t\t\t\t\tlet data ={\n\t\t\t\t\t\t\t\tarray:that.flowLineArr,\n\t\t\t\t\t\t\t\tcampId:that.campId,\n\t\t\t\t\t\t\t\tuserId:that.user.id,\n\t\t\t\t\t\t\t\tchessNumber: that.selCellInfo.chessPiecesNumber\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsendMsg(\n\t\t\t\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\t\t\t\taction: 'drawRoad',\n\t\t\t\t\t\t\t\t\tverdictRecordId: that.verdictRecordId,\n\t\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (that.isScout) {\n\t\t\t\t\t\tthat.targetCellInfo = {\n\t\t\t\t\t\t\toffset: h[0] + ',' + h[1],\n\t\t\t\t\t\t\tcoordinate: hex.hexToPointNumber(h[1], h[0], that.mapInfo.row, that.mapInfo.col)\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthat.$refs.scoutConfirm.open();\n\t\t\t\t\t} else if (that.isReactance) {\n\t\t\t\t\t\tthat.targetCellInfo = {\n\t\t\t\t\t\t\toffset: h[0] + ',' + h[1],\n\t\t\t\t\t\t\tcoordinate: hex.hexToPointNumber(h[1], h[0], that.mapInfo.row, that.mapInfo.col)\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthat.$refs.reactanceConfirm.open();\n\t\t\t\t\t}\n\t\t\t\t\telse if (that.isCommunication) {\n\t\t\t\t\t\tthat.targetCellInfo = {\n\t\t\t\t\t\t\toffset: h[0] + ',' + h[1],\n\t\t\t\t\t\t\tcoordinate: hex.hexToPointNumber(h[1], h[0], that.mapInfo.row, that.mapInfo.col)\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthat.$refs.communicationConfirm.open();\n\t\t\t\t\t} else if (that.isAttack) {\n\t\t\t\t\t\tthat.targetCellInfo = {\n\t\t\t\t\t\t\toffset: h[0] + ',' + h[1],\n\t\t\t\t\t\t\tcoordinate: hex.hexToPointNumber(h[1], h[0], that.mapInfo.row, that.mapInfo.col)\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthat.$refs.attackConfirm.open();\n\t\t\t\t\t}else {\n\t\t\t\t\t\t//获取格子里的棋子\n\t\t\t\t\t\tlet selectArray = that.getChessByOffset(h[0] + ',' + h[1]);\n\t\t\t\t\t\tif (selectArray.length <= 0 && !that.isMove) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//TODO 先不写棋子堆叠（默认一个棋子）\n\t\t\t\t\t\t\tlet chess = {};\n\t\t\t\t\t\t\tif (selectArray.length == 1) {\n\t\t\t\t\t\t\t\tchess = selectArray[0];\n\t\t\t\t\t\t\t} else if (selectArray.length > 1) {\n\t\t\t\t\t\t\t\t//展示棋子列表\n\t\t\t\t\t\t\t\t// if(chess.chessPiecesCampId == that.campId){\n\t\t\t\t\t\t\t\t\tthat.pointChessList = selectArray;\n\t\t\t\t\t\t\t\t\tthat.chessClick(e, 'chess');\n\t\t\t\t\t\t\t\t// }\n\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchess = {\n\t\t\t\t\t\t\t\t\toffset: h[0] + ',' + h[1],\n\t\t\t\t\t\t\t\t\tcoordinate: hex.hexToPointNumber(h[1], h[0], that.mapInfo.row, that.mapInfo.col)\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (chess.chessPiecesNumber && chess.chessPiecesCampId == that.campId) {\n\t\t\t\t\t\t\t\tthat.chessClick(e, 'action');\n\t\t\t\t\t\t\t\tthat.selCellInfo = chess;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// if (that.isAttack && chess.chessPiecesNumber && chess.status != 20) {\n\t\t\t\t\t\t\t\t// \tthat.targetCellInfo = chess;\n\t\t\t\t\t\t\t\t// \tthat.attackNumber = chess.chessPiecesNumber;\n\t\t\t\t\t\t\t\t// \tthat.$refs.attackConfirm.open();\n\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t// \tmap.on(['pointermove', 'click'], function (e) {\n\t\t\t// \t\t// Coords\n\t\t\t// \t\tvar h = grid.coord2hex(e.coordinate);\n\t\t\t// \t\tif (e.type != 'click' && h[0] == current[0] && h[1] == current[1]) return;\n\t\t\t// \t\tcurrent = h;\n\t\t\t// \t\tconsole.log(e);\n\t\t\t// \t\tMove\n\t\t\t// \t\tif (!text) {\n\t\t\t// \t\t\tvector.getSource().clear();\n\t\t\t// \t\t\tvar c = grid.hex2cube(grid.coord2hex(e.coordinate));\n\t\t\t// \t\t\tif (e.type == 'click') start = c;\n\t\t\t// \t\t\tif (start) {\n\t\t\t// \t\t\t\tvar l = grid.cube_line(start, c);\n\t\t\t// \t\t\t\tfor (var i = 0; i < l.length; i++) {\n\t\t\t// \t\t\t\t\tvar ex = grid.getHexagon(grid.cube2hex(l[i]));\n\t\t\t// \t\t\t\t\tvar f = new Feature(new Polygon([ex]));\n\t\t\t// \t\t\t\t\tf.setStyle(redStyle);\n\t\t\t// \t\t\t\t\tvector.getSource().addFeature(f);\n\t\t\t// \t\t\t\t}\n\t\t\t// \t\t\t\t// popup.show(e.coordinate, 'Move = ' + (l.length - 1) + ' hexagon' + (l.length > 2 ? 's' : ''));\n\t\t\t// \t\t\t}\n\t\t\t// \t\t\treturn;\n\t\t\t// \t\t}\n\n\t\t\t// \t\tpopup.hide();\n\n\t\t\t// \t\tvector.getSource().clear();\n\t\t\t// \t\tvar ex = grid.getHexagon(h);\n\t\t\t// \t\tvar f = new Feature(new Polygon([ex]));\n\t\t\t// \t\tvector.getSource().addFeature(f);\n\n\t\t\t// \t\tvar size = map.getSize();\n\t\t\t// \t\tsize = Math.round(\n\t\t\t// \t\t\t((Math.max(size[0], size[1]) / grid.getSize()) * map.getView().getResolution()) / Math.sqrt(3)\n\t\t\t// \t\t);\n\t\t\t// \t\tswitch (text) {\n\t\t\t// \t\t\tcase 'cube':\n\t\t\t// \t\t\t\tvar c = grid.hex2cube(h);\n\t\t\t// \t\t\t\t// popup.show(e.coordinate, 'x: ' + c[0] + ', y: ' + c[1] + ', z: ' + c[2]);\n\t\t\t// \t\t\t\tfor (var x = -size; x <= size; x++) {\n\t\t\t// \t\t\t\t\tif (x) {\n\t\t\t// \t\t\t\t\t\tex = grid.getHexagon(grid.cube2hex([c[0] + x, c[1] - x, c[2]]));\n\t\t\t// \t\t\t\t\t\tf = new Feature(new Polygon([ex]));\n\t\t\t// \t\t\t\t\t\tf.setStyle(greenStyle);\n\t\t\t// \t\t\t\t\t\tvector.getSource().addFeature(f);\n\t\t\t// \t\t\t\t\t\tex = grid.getHexagon(grid.cube2hex([c[0] + x, c[1], c[2] - x]));\n\t\t\t// \t\t\t\t\t\tf = new Feature(new Polygon([ex]));\n\t\t\t// \t\t\t\t\t\tf.setStyle(blueStyle);\n\t\t\t// \t\t\t\t\t\tvector.getSource().addFeature(f);\n\t\t\t// \t\t\t\t\t\tex = grid.getHexagon(grid.cube2hex([c[0], c[1] + x, c[2] - x]));\n\t\t\t// \t\t\t\t\t\tf = new Feature(new Polygon([ex]));\n\t\t\t// \t\t\t\t\t\tf.setStyle(redStyle);\n\t\t\t// \t\t\t\t\t\tvector.getSource().addFeature(f);\n\t\t\t// \t\t\t\t\t}\n\t\t\t// \t\t\t\t}\n\t\t\t// \t\t\t\tbreak;\n\t\t\t// \t\t\tcase 'axial':\n\t\t\t// \t\t\t\t// popup.show(e.coordinate, 'x: ' + h[0] + ', y: ' + h[1]);\n\t\t\t// \t\t\t\tfor (var x = -size; x <= size; x++) {\n\t\t\t// \t\t\t\t\tif (x) {\n\t\t\t// \t\t\t\t\t\tex = grid.getHexagon([h[0] + x, h[1]]);\n\t\t\t// \t\t\t\t\t\tf = new Feature(new Polygon([ex]));\n\t\t\t// \t\t\t\t\t\tf.setStyle(greenStyle);\n\t\t\t// \t\t\t\t\t\tvector.getSource().addFeature(f);\n\t\t\t// \t\t\t\t\t\tex = grid.getHexagon([h[0], h[1] + x]);\n\t\t\t// \t\t\t\t\t\tf = new Feature(new Polygon([ex]));\n\t\t\t// \t\t\t\t\t\tf.setStyle(blueStyle);\n\t\t\t// \t\t\t\t\t\tvector.getSource().addFeature(f);\n\t\t\t// \t\t\t\t\t}\n\t\t\t// \t\t\t\t}\n\t\t\t// \t\t\t\tbreak;\n\t\t\t// \t\t\tcase 'offset':\n\t\t\t// \t\t\t\tvar o = grid.hex2offset(h);\n\t\t\t// \t\t\t\t// popup.show(e.coordinate, 'x: ' + o[0] + ', y: ' + o[1]);\n\t\t\t// \t\t\t\tfor (var x = -size; x <= size; x++) {\n\t\t\t// \t\t\t\t\tif (x) {\n\t\t\t// \t\t\t\t\t\tex = grid.getHexagon(grid.offset2hex([o[0] + x, o[1]]));\n\t\t\t// \t\t\t\t\t\tf = new Feature(new Polygon([ex]));\n\t\t\t// \t\t\t\t\t\tf.setStyle(greenStyle);\n\t\t\t// \t\t\t\t\t\tvector.getSource().addFeature(f);\n\t\t\t// \t\t\t\t\t\tex = grid.getHexagon(grid.offset2hex([o[0], o[1] + x]));\n\t\t\t// \t\t\t\t\t\tf = new Feature(new Polygon([ex]));\n\t\t\t// \t\t\t\t\t\tf.setStyle(blueStyle);\n\t\t\t// \t\t\t\t\t\tvector.getSource().addFeature(f);\n\t\t\t// \t\t\t\t\t}\n\t\t\t// \t\t\t\t}\n\t\t\t// \t\t\t\tbreak;\n\t\t\t// \t\t\tdefault:\n\t\t\t// \t\t\t\tbreak;\n\t\t\t// \t\t}\n\t\t\t// \t});\n\t\t},\n\t\tdrawRoad(data){\n\t\t\tconsole.log(\"接受drawroad\",(this.initType == \"watch\" || this.userType == \"admin\" || this.campId == data.campId) && this.user.id != data.userId);\n\t\t\tif((this.initType == \"watch\" || this.userType == \"admin\" || this.campId == data.campId) && this.user.id != data.userId){\n\t\t\t\tvar feature= vector.getSource().getFeatureById(data.chessNumber)\n\t\t\t\tif(feature){\n\t\t\t\t\tvector.getSource().removeFeature(feature);\n\t\t\t\t}\n\t\t\t\tvar flowStyle = new FlowLine({\n\t\t\t\t\tcolor: 'red',\n\t\t\t\t\tcolor2: 'red',\n\t\t\t\t\twidth: 8,\n\t\t\t\t\twidth2: 8,\n\t\t\t\t\t_acolor: 'red',\n\t\t\t\t\tarrow: 1\n\t\t\t\t});\n\t\t\t\tvar l = new Feature({\n\t\t\t\t\tgeometry: new LineString(data.array),\n\t\t\t\t\tstyle: flowStyle,\n\t\t\t\t\ttype: 'LineString'\n\t\t\t\t});\n\t\t\t\tl.setId(data.chessNumber);\n\t\t\t\tvector.getSource().addFeature(l);\n\t\t\t}\n\n\t\t},\n\t\tchessMove(offset) {\n\t\t\tif (this.chessMoveArray.length == 0) {\n\t\t\t\tlet data = {\n\t\t\t\t\toffset: this.selCellInfo.offset,\n\t\t\t\t\tcoordinate: this.selCellInfo.coordinate\n\t\t\t\t};\n\t\t\t\tthis.chessMoveArray.push(data);\n\t\t\t}\n\t\t\tlet actionValue = this.selCellInfo.maneuverValue;\n\t\t\tlet data = this.actionUseUp(offset);\n\t\t\tif (data.useUp == -1 || data.useUp > this.selCellInfo.maneuverValue) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '行动失败！'\n\t\t\t\t});\n\t\t\t\tthis.selCellInfo.attackResult = '行动失败';\n\t\t\t\tdata.residue = this.selCellInfo.maneuverValue - data.useUp;\n\t\t\t\tthis.isAttack = false;\n\t\t\t\tthis.isMove = false;\n\t\t\t\tthis.chessPiecesActionFunc(10, this.selCellInfo, this.targetCellInfo, false);\n\t\t\t} else {\n\t\t\t\tthis.selCellInfo.maneuverValue = this.selCellInfo.maneuverValue - data.useUp;\n\t\t\t\tdata.residue = this.selCellInfo.maneuverValue;\n\t\t\t}\n\n\t\t\tif (this.selCellInfo.actionInfoArray == undefined) {\n\t\t\t\tthis.selCellInfo.actionInfoArray = [];\n\t\t\t}\n\n\t\t\tthis.selCellInfo.actionInfoArray.push(data);\n\t\t},\n\t\tactionUseUp(offset) {\n\t\t\tlet data = {\n\t\t\t\tslope: 0,\n\t\t\t\tterrain: 0,\n\t\t\t\troad: 0,\n\t\t\t\tuseUp: 0,\n\t\t\t\tresidue: 0,\n\t\t\t\toffset: '',\n\t\t\t\tcoordinate: ''\n\t\t\t};\n\t\t\tlet offsetString = offset.join(',');\n\t\t\tdata.offset = offsetString;\n\n\t\t\t//获取上一个点的信息\n\t\t\tlet previousPoint = this.coordinateMap[this.chessMoveArray[this.chessMoveArray.length - 1].offset];\n\t\t\t//获取当前点信息\n\t\t\tlet thisPoint = this.coordinateMap[offsetString];\n\t\t\tdata.coordinate = thisPoint.coordinate;\n\t\t\tlet useUp = 1; //初始消耗1\n\t\t\t//坡度修正\n\t\t\tlet podu = Math.abs(thisPoint.elevation - previousPoint.elevation);\n\t\t\tlet poduLevel = Math.ceil(podu / 20);\n\t\t\tif (poduLevel == 1) {\n\t\t\t\tuseUp += 0.2;\n\t\t\t\tdata.slope = 0.2;\n\t\t\t} else if (poduLevel == 2) {\n\t\t\t\tuseUp += 0.5;\n\t\t\t\tdata.slope = 0.5;\n\t\t\t} else if (poduLevel == 3) {\n\t\t\t\tuseUp += 0.5;\n\t\t\t\tdata.slope = 0.5;\n\t\t\t} else if (poduLevel == 4) {\n\t\t\t\tuseUp += 1;\n\t\t\t\tdata.slope = 1;\n\t\t\t} else if (poduLevel == 5) {\n\t\t\t\tuseUp += 1.5;\n\t\t\t} else if (poduLevel == 6) {\n\t\t\t\tuseUp += 2;\n\t\t\t\tdata.slope = 2;\n\t\t\t} else if (poduLevel >= 7) {\n\t\t\t\treturn -1; //机动失败\n\t\t\t}\n\t\t\t//区域修正\n\t\t\tif (\n\t\t\t\tthisPoint.terrainName == '树林' ||\n\t\t\t\tthisPoint.terrainName == '灌木' ||\n\t\t\t\tthisPoint.terrainName == '居民地' ||\n\t\t\t\tthisPoint.terrainName == '居民地（古典）'\n\t\t\t) {\n\t\t\t\tuseUp += 1;\n\t\t\t\tdata.terrain = 1;\n\t\t\t\tconsole.log('地形类型：' + thisPoint.terrainName + '修正系数：' + 1);\n\t\t\t} else if (thisPoint.terrainName == '湖泊') {\n\t\t\t\tuseUp += 1;\n\t\t\t\tdata.terrain = 1;\n\t\t\t\tconsole.log('地形类型：' + thisPoint.terrainName + '修正系数：' + 1);\n\t\t\t}\n\t\t\t//道路修正\n\t\t\tlet previousCoordinate = this.chessMoveArray[this.chessMoveArray.length - 1].coordinate;\n\t\t\tlet thisCoordinate = this.hex.hexToPointNumber(offset[1], offset[0], this.mapInfo.row, this.mapInfo.col);\n\t\t\tconsole.log('当前点坐标：' + thisCoordinate);\n\t\t\t//是否是路\n\t\t\tlet roadArray = []; //点位道路集合\n\t\t\tif (thisPoint.roadVoList) {\n\t\t\t\troadArray = roadArray.concat(thisPoint.roadVoList);\n\t\t\t}\n\t\t\tif (previousCoordinate.roadVoList) {\n\t\t\t\troadArray = roadArray.concat(previousCoordinate.roadVoList);\n\t\t\t}\n\t\t\tlet correctRoadArray = [];\n\t\t\tfor (let item of roadArray) {\n\t\t\t\tif (\n\t\t\t\t\t(item.toCoordinate == previousCoordinate && item.fromCoordinate == thisCoordinate) ||\n\t\t\t\t\t(item.toCoordinate == thisCoordinate && item.fromCoordinate == previousCoordinate)\n\t\t\t\t) {\n\t\t\t\t\tcorrectRoadArray.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (correctRoadArray.length > 0) {\n\t\t\t\tcorrectRoadArray = correctRoadArray.sort((a, b) => a.terrainActionValue - b.terrainActionValue);\n\t\t\t\tuseUp -= correctRoadArray[0].terrainActionValue;\n\t\t\t\tconsole.log('道路类型修正系数：' + correctRoadArray[0].terrainActionValue);\n\t\t\t\tdata.road = -correctRoadArray[0].terrainActionValue;\n\t\t\t}\n\t\t\t//隔间地物（湖泊为区域修正）\n\t\t\tconsole.log('消耗行动值: ', useUp);\n\t\t\tdata.useUp = useUp;\n\t\t\tlet chessMoveData = {\n\t\t\t\toffset: offsetString,\n\t\t\t\tcoordinate: thisCoordinate\n\t\t\t};\n\t\t\tthis.chessMoveArray.push(chessMoveData);\n\t\t\tthis.hex.chessMoveChange(this.chessMoveArray);\n\t\t\treturn data;\n\t\t},\n\t\tcheckCanAttack() {\n\t\t\tif (this.game.roundPeriod == 1 || this.game.roundPeriod == 4) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tattackPoint() {\n\t\t\tthis.isAttack = false;\n\t\t\tthis.isMove = false;\n\t\t\tthis.$refs.moveConfirm.close();\n\t\t\tthis.$refs.attackConfirm.close();\n\t\t\tthis.chessPiecesActionFunc(20, this.selCellInfo, this.targetCellInfo, true);\n\t\t},\n\t\tscoutPoint() {\n\t\t\tthis.isScout = false;\n\t\t\tthis.$refs.scoutConfirm.close();\n\t\t\tthis.chessPiecesActionFunc(40, this.selCellInfo, this.targetCellInfo, false);\n\t\t},\n\t\treactancePoint(){\n\t\t\tthis.isReactance = false;\n\t\t\tthis.$refs.reactanceConfirm.close();\n\t\t\tthis.chessPiecesActionFunc(60, this.selCellInfo, this.targetCellInfo, false);\n\t\t},\n\t\tcommunicationPoint() {\n\t\t\tthis.isCommunication = false;\n\t\t\tthis.$refs.communicationConfirm.close();\n\t\t\tthis.chessPiecesActionFunc(50, this.selCellInfo, this.targetCellInfo, false);\n\t\t},\n\t\tmovePoint() {\n\t\t\tthis.isAttack = false;\n\t\t\tthis.isMove = false;\n\t\t\tthis.$refs.moveConfirm.close();\n\t\t\tthis.$refs.attackConfirm.close();\n\t\t\tthis.chessPiecesActionFunc(this.selCellInfo, this.targetCellInfo, false);\n\t\t},\n\t\tmoveStop() {\n\t\t\tthis.isAttack = false;\n\t\t\tthis.isMove = false;\n\t\t\t// this.selCellInfo.attackResult = '行动成功';\n\t\t\tthis.selCellInfo.moveInfo = this.flowLineArr;\n\t\t\tthis.flowLineArr = [];\n\t\t\tthis.chessPiecesActionFunc(10, this.selCellInfo, this.targetCellInfo, false);\n\t\t},\n\t\tasync chessPiecesActionFunc(actionMode, source, target, isAttack, isHide) {\n\t\t\tlet data = {\n\t\t\t\tactionMode: actionMode,\n\t\t\t\tcampId: this.campId,\n\t\t\t\tchessPiecesNumber: source.chessPiecesNumber,\n\t\t\t\tselfCoordinate: source.coordinate,\n\t\t\t\tselfOffset: source.offset,\n\t\t\t\ttargetCoordinate: target.coordinate,\n\t\t\t\ttargetOffset: target.offset,\n\t\t\t\tuserId: this.user.id,\n\t\t\t\tverdictRecordId: this.verdictRecordId,\n\t\t\t\ttargetChessPiecesNumber: target.chessPiecesNumber,\n\t\t\t\tchessRound: this.roundActive,\n\t\t\t\troundPeriod: this.stageActive + 1,\n\t\t\t\tmoveInfo: JSON.stringify(source.moveInfo),\n\t\t\t\tattackResult: source.attackResult\n\t\t\t};\n\t\t\tisHide && (data.actionMode = 30);\n\n\t\t\tawait chessPiecesActionNew(data);\n\t\t\tif (actionMode == 10) {\n\t\t\t\tthis.queryUsChessPiecesInfoFunc();\n\t\t\t\tsendMsg(\n\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\taction: 'refresh',\n\t\t\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// let index = this.selectIndex[0];\n\t\t\t// let itemArray = this.mapList[index];\n\t\t\t// let item = itemArray[this.selectIndex[1]];\n\t\t\t// item.isAction = true;\n\t\t\t// this.$set(itemArray, this.selectIndex[1], item);\n\t\t\t// this.$set(this.mapList, index, itemArray);\n\t\t\tawait this.queryPromptFunc();\n\t\t},\n\t\tshowChessAction(e, item) {\n\t\t\tthis.selCellInfo = item;\n\t\t\tsetTimeout(() => {\n\t\t\t\tlet x = e.detail.x; //这个应该是相对于整个浏览器页面的x坐标，左上角为坐标原点（0,0）\n\t\t\t\tlet y = e.detail.y; //这个应该是相对于整个浏览器页面的y坐标，左上角为坐标原点（0,0）\n\t\t\t\tthis.showChessButtonInfo.top = y;\n\t\t\t\tthis.showChessButtonInfo.left = x;\n\t\t\t\tthis.showChessButtonInfo.visible = true;\n\t\t\t}, 100);\n\t\t},\n\t\tchessClick(e, type) {\n\t\t\tif (type == 'action') {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tlet x = e.originalEvent.pageX; //这个应该是相对于整个浏览器页面的x坐标，左上角为坐标原点（0,0）\n\t\t\t\t\tlet y = e.originalEvent.pageY; //这个应该是相对于整个浏览器页面的y坐标，左上角为坐标原点（0,0）\n\t\t\t\t\tthis.showChessButtonInfo.top = y;\n\t\t\t\t\tthis.showChessButtonInfo.left = x;\n\t\t\t\t\tthis.showChessButtonInfo.visible = true;\n\t\t\t\t}, 100);\n\t\t\t} else if (type == 'chess') {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tlet x = e.originalEvent.pageX; //这个应该是相对于整个浏览器页面的x坐标，左上角为坐标原点（0,0）\n\t\t\t\t\tlet y = e.originalEvent.pageY; //这个应该是相对于整个浏览器页面的y坐标，左上角为坐标原点（0,0）\n\t\t\t\t\tthis.showChessListInfo.top = y;\n\t\t\t\t\tthis.showChessListInfo.left = x;\n\t\t\t\t\tthis.showChessListInfo.visible = true;\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t},\n\t\tattack() {\n\t\t\tthis.isAttack = true;\n\t\t\tthis.isMove = false;\n\t\t\tthis.showChessButtonInfo.visible = false;\n\t\t\tthis.showChessListInfo.visible = false;\n\t\t},\n\t\treactance(){\n\t\t\tthis.isReactance = true\n\t\t\tthis.showChessButtonInfo.visible = false;\n\t\t\tthis.showChessListInfo.visible = false;\n\t\t},\n\t\tmove() {\n\t\t\tthis.isAttack = false;\n\t\t\tthis.isMove = true;\n\t\t\tthis.showChessButtonInfo.visible = false;\n\t\t\tthis.showChessListInfo.visible = false;\n\t\t\t// this.flowLineArr\n\t\t},\n\t\tscout() {\n\t\t\tthis.isScout = true;\n\t\t\tthis.showChessButtonInfo.visible = false;\n\t\t\tthis.showChessListInfo.visible = false;\n\t\t},\n\t\tcommunication() {\n\t\t\tthis.isCommunication = true;\n\t\t\tthis.showChessButtonInfo.visible = false;\n\t\t\tthis.showChessListInfo.visible = false;\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '请点击通信点位！',\n\t\t\t\ticon: 'none',\n\t\t\t\tduration: 1500\n\t\t\t});\n\t\t},\n\t\thide() {\n\t\t\tthis.isAttack = false;\n\t\t\tthis.isMove = false;\n\t\t\tthis.showChessButtonInfo.visible = false;\n\t\t\tthis.showChessListInfo.visible = false;\n\t\t\tthis.chessPiecesActionFunc(this.selCellInfo, this.selCellInfo, false, true);\n\t\t},\n\t\tgetChessByOffset(offset) {\n\t\t\tlet selectArray = [];\n\t\t\tfor (let item of this.mapChessArray) {\n\t\t\t\tif (item.offset == offset) {\n\t\t\t\t\tselectArray.push(item.info);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn selectArray;\n\t\t},\n\t\tasync queryAllFunc() {\n\t\t\tuni.hideLoading()\n\t\t\tlet data = {\n\t\t\t\tid: this.verdictRecordId\n\t\t\t};\n\t\t\tlet rst = await queryVerdictResult(data);\n\t\t\tlet resultData = rst.data.data;\n\t\t\tfor (var key in resultData) {\n\t\t\t\tthis.game[key] = resultData[key];\n\t\t\t}\n\t\t\tthis.roundActive = this.game.chessRound;\n\t\t\t//格式化用户\n\t\t\tthis.formatterUser();\n\t\t\t//格式化campList\n\n\t\t\tthis.chessRoundLimit = resultData.chessRoundLimit;\n\t\t\tthis.initialRoundOptions(this.chessRoundLimit);\n\t\t\tthis.getRoundStatus();\n\t\t\tif (this.game.status < 30) {\n\t\t\t\tthis.game.nowRound = 0;\n\t\t\t} else {\n\t\t\t\tthis.game.nowRound = this.game.chessRound;\n\t\t\t}\n\n\t\t\tif(this.game.status == 50){\n\t\t\t\tthis.getFinalSummary();\n\t\t\t}\n\t\t\tthis.queryUsChessPiecesInfoFunc();\n\t\t},\n\t\tformatterUser() {\n\t\t\tif (this.user.id == this.game.inviterUserId) {\n\t\t\t\tthis.userType = 'admin';\n\t\t\t\tthis.avatarText = '导演';\n\t\t\t}\n\t\t\tif (this.user.id == this.game.firstUserId || this.user.id == this.game.secondUserId) {\n\t\t\t\tthis.userType = 'user';\n\t\t\t\tif (this.user.id == this.game.firstUserId) {\n\t\t\t\t\tthis.avatarText = this.game.firstCampName;\n\t\t\t\t} else if (this.user.id == this.game.secondUserId) {\n\t\t\t\t\tthis.avatarText = this.game.secondCampName;\n\t\t\t\t}\n\t\t\t\tthis.avatarDesc = '控制员';\n\t\t\t}\n\t\t\tif (this.user.id == this.game.firstJudgeUserId || this.user.id == this.game.secondJudgeUserId) {\n\t\t\t\tthis.userType = 'judge';\n\t\t\t\tif (this.user.id == this.game.firstJudgeUserId) {\n\t\t\t\t\tthis.avatarText = this.game.firstCampName;\n\t\t\t\t} else if (this.user.id == this.game.secondJudgeUserId) {\n\t\t\t\t\tthis.avatarText = this.game.secondCampName;\n\t\t\t\t}\n\t\t\t\tthis.avatarDesc = '裁决员';\n\t\t\t}\n\n\t\t\tthis.formatterCampList();\n\t\t},\n\t\tinitialRoundOptions(round) {\n\t\t\tthis.stageOptions = [];\n\t\t\tlet stageArray = this.game.stageStr.split(',');\n\t\t\tfor (let item of stageArray) {\n\t\t\t\tthis.stageOptions.push({\n\t\t\t\t\ttitle: item\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.roundOptions = [{ title: '部署阶段' }];\n\t\t\tfor (let i = 0; i <= round - 1; i++) {\n\t\t\t\tthis.roundOptions.push({ title: '回   合   ' + Number(i + 1) });\n\t\t\t}\n\t\t\tthis.stageActive = this.game.roundPeriod - 1;\n\n\t\t\tthis.queryPromptFunc();\n\t\t},\n\t\tformatterCampList() {\n\t\t\tthis.campList = [];\n\t\t\tlet dataFirst = {\n\t\t\t\tcampId: this.game.firstCampId,\n\t\t\t\tcampName: this.game.firstCampName,\n\t\t\t\tuserId: this.game.firstUserId,\n\t\t\t\tuserName: this.game.firstUserName,\n\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t};\n\t\t\tthis.campList.push(dataFirst);\n\t\t\tlet dataSecond = {\n\t\t\t\tcampId: this.game.secondCampId,\n\t\t\t\tcampName: this.game.secondCampName,\n\t\t\t\tuserId: this.game.secondUserId,\n\t\t\t\tuserName: this.game.secondUserName,\n\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t};\n\t\t\tthis.campList.push(dataSecond);\n\t\t},\n\t\tasync queryPromptFunc() {\n\t\t\tlet data = {\n\t\t\t\tid: this.verdictRecordId\n\t\t\t};\n\t\t\tdata.userId = this.user.id;\n\t\t\tlet prompt = await queryPrompt(data);\n\t\t\tlet array = [];\n\t\t\tthis.historyList = prompt.data.data.verdictRecordHistoryList;\n\t\t\tfor (let i in this.historyList) {\n\t\t\t\tarray.push(this.historyList[i].actionDesc);\n\t\t\t}\n\t\t\tarray.filter(function (s) {\n\t\t\t\treturn s && s.trim();\n\t\t\t});\n\t\t\tthis.game.actionDescList = array;\n\t\t},\n\t\tasync getRoundStatus() {\n\t\t\tlet data = {\n\t\t\t\tverdictRecordId: this.verdictRecordId,\n\t\t\t\tchessRound: this.roundActive,\n\t\t\t\troundPeriod: this.stageActive + 1\n\t\t\t};\n\t\t\tthis.roundStatusList = [];\n\t\t\tlet result = await getRoundStatus(data);\n\t\t\tthis.roundStatusList = result.data.data;\n\t\t\tthis.formatterStatusDesc(this.roundStatusList);\n\t\t},\n\t\tformatterStatusDesc(newVal) {\n\t\t\tif (this.userType == 'admin') {\n\t\t\t\tlet sum = 0;\n\t\t\t\tfor (let item of newVal) {\n\t\t\t\t\tsum += item.status;\n\t\t\t\t}\n\t\t\t\tif (sum == 0) {\n\t\t\t\t\tthis.statusDesc = '未提交';\n\t\t\t\t\tthis.statusIndex = 0;\n\t\t\t\t} else if (sum == 1) {\n\t\t\t\t\tthis.statusDesc = '一方已提交';\n\t\t\t\t\tthis.statusIndex = 0;\n\t\t\t\t} else if (sum == 2) {\n\t\t\t\t\tthis.statusDesc = '待裁决';\n\t\t\t\t\tthis.statusIndex = 1;\n\t\t\t\t} else if (sum == 3) {\n\t\t\t\t\tthis.statusDesc = '待裁决';\n\t\t\t\t\tthis.statusIndex = 1;\n\t\t\t\t} else if (sum == 4) {\n\t\t\t\t\tthis.statusDesc = '已裁决';\n\t\t\t\t\tif(this.game.status != 50){\n\t\t\t\t\t\tthis.nextStageFlag = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.statusIndex = 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.roundEnd = false;\n\t\t\t\tfor (let item of newVal) {\n\t\t\t\t\tif (item.campId == this.campId) {\n\t\t\t\t\t\tif (item.status == 0) {\n\t\t\t\t\t\t\tthis.statusDesc = '未提交';\n\t\t\t\t\t\t\tthis.statusIndex = 0;\n\t\t\t\t\t\t\tthis.userStageNotSubmit = true;\n\t\t\t\t\t\t} else if (item.status == 1) {\n\t\t\t\t\t\t\tthis.statusDesc = '待裁决';\n\t\t\t\t\t\t\tthis.statusIndex = 1;\n\t\t\t\t\t\t\tthis.userStageNotSubmit = false;\n\t\t\t\t\t\t\tif (this.userType == 'judge') {\n\t\t\t\t\t\t\t\tthis.roundEnd = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.statusDesc = '已裁决';\n\t\t\t\t\t\t\tthis.statusIndex = 1;\n\t\t\t\t\t\t\tthis.userStageNotSubmit = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.nextStageFlag && this.stageActive == this.stageOptions.length-1 && this.roundActive == this.chessRoundLimit){\n\t\t\t\tthis.nextBtnText = \"游戏结束\";\n\t\t\t}\n\t\t},\n\t\tasync queryUsChessPiecesInfoFunc() {\n\t\t\tlet data = {\n\t\t\t\tverdictRecordId: this.verdictRecordId,\n\t\t\t\tchessRound: this.game.chessRound,\n\t\t\t\troundPeriod: this.stageActive + 1\n\t\t\t};\n\t\t\tlet res = '';\n\t\t\tif (this.userType == 'user') {\n\t\t\t\tdata.campId = this.campId;\n\t\t\t\tres = await queryAllChessPiecesInfo(data);\n\t\t\t} else {\n\t\t\t\tres = await queryAllChessPiecesInfo(data);\n\t\t\t}\n\t\t\tthis.game.userPiece = [];\n\t\t\tlet array = res.data.data;\n\t\t\tfor (let item of array) {\n\t\t\t\titem.isAdd = false;\n\t\t\t\titem.canMove = true;\n\t\t\t\titem.isDie = false;\n\t\t\t\tlet oss = await getOssById(item.chessPiecesCover);\n\t\t\t\tlet coverUrl = this.baseOssIpPort + oss.data.data.fileName;\n\t\t\t\titem.chessPiecesCover = coverUrl;\n\t\t\t\tthis.game.userPiece.push(item);\n\t\t\t}\n\t\t\tthis.formatterAllChessPiecesInfo(array);\n\t\t},\n\t\tformatterAllChessPiecesInfo(array) {\n\t\t\tthis.mapChessArray = [];\n\t\t\tfor (let item of array) {\n\t\t\t\tif (item.offset) {\n\t\t\t\t\tthis.mapChessArray.push({\n\t\t\t\t\t\toffset: item.offset,\n\t\t\t\t\t\tinfo: item\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.hex.moveChessImage(this.mapChessArray);\n\t\t},\n\t\tasync getRealTimeScore() {\n\t\t\tif (!this.showRealTimeScoreFlag) {\n\t\t\t\tlet queryScoreData = {\n\t\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t\t};\n\t\t\t\tlet scoreListResult = await getRealTimeScore(queryScoreData);\n\t\t\t\tlet realTimeScoreList = scoreListResult.data.data;\n\t\t\t\tthis.realTimeScore.firstScoretypeTotal = 0;\n\t\t\t\tthis.realTimeScore.secondScoretypeTotal = 0;\n\t\t\t\tthis.realTimeScore.firstCampName = this.campList[0].campName;\n\t\t\t\tthis.realTimeScore.secondCampName = this.campList[1].campName;\n\t\t\t\tfor (var i in realTimeScoreList) {\n\t\t\t\t\tif (this.campList[0].campId == realTimeScoreList[i].campId) {\n\t\t\t\t\t\tif (realTimeScoreList[i].type == 1) {\n\t\t\t\t\t\t\tthis.realTimeScore.firstScoretype1 = realTimeScoreList[i].score;\n\t\t\t\t\t\t} else if (realTimeScoreList[i].type == 2) {\n\t\t\t\t\t\t\tthis.realTimeScore.firstScoretype2 = realTimeScoreList[i].score;\n\t\t\t\t\t\t} else if (realTimeScoreList[i].type == 3) {\n\t\t\t\t\t\t\tthis.realTimeScore.firstScoretype3 = realTimeScoreList[i].score;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.realTimeScore.firstScoretypeTotal += realTimeScoreList[i].score;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (realTimeScoreList[i].type == 1) {\n\t\t\t\t\t\t\tthis.realTimeScore.secondScoretype1 = realTimeScoreList[i].score;\n\t\t\t\t\t\t} else if (realTimeScoreList[i].type == 2) {\n\t\t\t\t\t\t\tthis.realTimeScore.secondScoretype2 = realTimeScoreList[i].score;\n\t\t\t\t\t\t} else if (realTimeScoreList[i].type == 3) {\n\t\t\t\t\t\t\tthis.realTimeScore.secondScoretype3 = realTimeScoreList[i].score;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.realTimeScore.secondScoretypeTotal += realTimeScoreList[i].score;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$refs.showRealTimeScore.open();\n\t\t\t} else {\n\t\t\t\tthis.$refs.showRealTimeScore.close();\n\t\t\t}\n\t\t\tthis.showRealTimeScoreFlag = !this.showRealTimeScoreFlag;\n\t\t},\n\t\tgetJudgeTable() {\n\t\t\tthis.judgeTableShowInfo = {\n\t\t\t\ttype: 'input',\n\t\t\t\tverdictRecordId: this.verdictRecordId,\n\t\t\t\tchessRound: this.roundActive,\n\t\t\t\troundPeriod: this.stageActive + 1,\n\t\t\t\troundPeriodName: this.stageOptions[this.stageActive].title\n\t\t\t};\n\t\t\tif (this.userType == 'user' || this.userType == 'judge') {\n\t\t\t\tthis.judgeTableShowInfo.campId = this.campId;\n\t\t\t}\n\t\t\tthis.$refs.judgeTable.open();\n\t\t},\n\t\tasync scoreTableShow(item, index) {\n\t\t\titem.chessRound = index;\n\t\t\tthis.campListItem = item;\n\t\t\t//查询历史打分结果\n\t\t\tlet queryScoreData = {\n\t\t\t\tverdictRecordId: item.verdictRecordId,\n\t\t\t\tcampId: item.campId,\n\t\t\t\tchessRound: index\n\t\t\t};\n\t\t\tlet scoreListResult = await queryScoreList(queryScoreData);\n\t\t\tthis.scoreList = scoreListResult.data.data;\n\t\t\tthis.$refs.scoreTable.open();\n\t\t\tthis.showScoreButtonInfo.visible = false;\n\t\t},\n\t\tgetJudgeResult() {\n\t\t\tthis.judgeTableShowInfo = {\n\t\t\t\ttype: 'record',\n\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t};\n\t\t\tif (this.userType == 'user' || this.userType == 'judge') {\n\t\t\t\tthis.judgeTableShowInfo.campId = this.campId;\n\t\t\t}\n\t\t\tthis.$refs.judgeTable.open();\n\t\t},\n\t\tasync getTableScoreFinal() {\n\t\t\tthis.finalData = this.campList;\n\t\t\t//获取推演打分记录\n\t\t\tlet queryScoreData = {\n\t\t\t\tverdictRecordId: this.verdictRecordId,\n\t\t\t\ttypeString: '4,5'\n\t\t\t};\n\t\t\tlet scoreListResult = await queryScoreList(queryScoreData);\n\t\t\tthis.finalScoreList = scoreListResult.data.data;\n\t\t\tthis.$refs.scoreTableFinal.open();\n\t\t},\n\t\tasync submitScoreFinal(scoreList) {\n\t\t\tlet res = await submitScore(scoreList);\n\t\t\tif (res.data.code == 200) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '提交成功',\n\t\t\t\t\ticon: 'none',\n\t\t\t\t\tduration: 1500\n\t\t\t\t});\n\t\t\t\tthis.$refs.scoreTableFinal.close();\n\t\t\t} else {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '提交失败！',\n\t\t\t\t\ticon: 'error',\n\t\t\t\t\tduration: 1500\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tasync getFinalSummary() {\n\t\t\tlet queryScoreData = {\n\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t};\n\t\t\tlet res = await getSummaryScore(queryScoreData);\n\t\t\tthis.chartRound = this.chessRoundLimit;\n\t\t\tthis.summaryScoreData = res.data.data;\n\t\t\tthis.$refs.finalSummary.open();\n\t\t},\n\t\tselPiece(val) {\n\t\t\tthis.selCellInfo.chessPiecesNumber = val.chessPiecesNumber;\n\t\t\tthis.selCellInfo.coordinate = this.hex.hexToPointNumber(\n\t\t\t\tthis.pointOffset[1],\n\t\t\t\tthis.pointOffset[0],\n\t\t\t\tthis.mapInfo.row,\n\t\t\t\tthis.mapInfo.col\n\t\t\t);\n\t\t\tthis.selCellInfo.offset = this.pointOffset.join(',');\n\t\t\tthis.deployChessPiecesFunc(this.selCellInfo, true);\n\t\t\tval.isAdd = true;\n\t\t\tthis.$refs.showSelPiece.close();\n\t\t\t//更新地图棋子数组\n\t\t\tthis.formatterMapChessArray(this.selCellInfo.offset, val);\n\t\t},\n\t\tformatterMapChessArray(offset, info) {\n\t\t\t//查询是否有重复的棋子\n\t\t\tlet isHave = false;\n\t\t\tfor (let item of this.mapChessArray) {\n\t\t\t\tif (item.offset == offset && item.info.chessPiecesNumber == info.chessPiecesNumber) {\n\t\t\t\t\titem.info = info;\n\t\t\t\t\tisHave = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!isHave) {\n\t\t\t\tthis.mapChessArray.push({\n\t\t\t\t\toffset: offset,\n\t\t\t\t\tinfo: info\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.hex.moveChessImage(this.mapChessArray);\n\t\t},\n\t\tdeployChessPiecesFunc(val, isAdd) {\n\t\t\tlet data = {\n\t\t\t\tactionMode: 10,\n\t\t\t\tcampId: this.campId,\n\t\t\t\tchessPiecesNumber: val.chessPiecesNumber,\n\t\t\t\tselfCoordinate: 'string',\n\t\t\t\ttargetCoordinate: 'string',\n\t\t\t\tuserId: this.user.id,\n\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t};\n\t\t\tif (isAdd) {\n\t\t\t\tdata.selfCoordinate = '0000';\n\t\t\t\tdata.targetCoordinate = val.coordinate;\n\t\t\t\tdata.targetOffset = val.offset;\n\t\t\t} else {\n\t\t\t\tdata.selfCoordinate = val.coordinate;\n\t\t\t\tdata.selfOffset = val.offset;\n\t\t\t\tdata.targetCoordinate = '0000';\n\t\t\t}\n\t\t\tdeployChessPieces(data);\n\t\t},\n\t\tendDeployFunc() {\n\t\t\tlet data = {\n\t\t\t\tverdictRecordId: this.verdictRecordId,\n\t\t\t\tuserId: this.user.id\n\t\t\t};\n\t\t\tendDeploy(data).then((res) => {\n\t\t\t\tif (res.data.code == 200) {\n\t\t\t\t\tsendMsg(\n\t\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\t\taction: 'takeAction',\n\t\t\t\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.game.isDeplaoy = false;\n\t\t},\n\t\tshakeDice(diceArr) {\n\t\t\tthis.$refs.popup.open();\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tfor (var i = 0; i < this.diceCount; i++) {\n\t\t\t\t\tthis.$refs[`dice${i}`][0].throwDice(diceArr[i]);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetRuleListAsync() {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tgetRuleList({ verdictType: 10 }).then((res) => {\n\t\t\t\t\tresolve(res.data.data);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tasync getRuleList() {\n\t\t\tlet data = {\n\t\t\t\tverdictType: 10\n\t\t\t};\n\t\t\tlet ruleRes = await getRuleList(data);\n\t\t\tthis.ruleArray = ruleRes.data.data;\n\t\t\tthis.$refs.popupRule.open();\n\t\t},\n\t\tsleep(ms) {\n\t\t\treturn new Promise((resolve) => setTimeout(resolve, ms));\n\t\t},\n\t\tasync judgeShow(dataArray) {\n\t\t\tlet that = this;\n\t\t\tfor (let i = 0; i < dataArray.length; i++) {\n\t\t\t\tlet data = {\n\t\t\t\t\tverdictType: 10\n\t\t\t\t};\n\t\t\t\tlet ruleRes = await getRuleList(data);\n\t\t\t\tthat.ruleArray = ruleRes.data.data;\n\t\t\t\tconsole.log('打开规则表');\n\t\t\t\tthat.$refs.popupRule.open();\n\t\t\t\tawait that.sleep(5000);\n\t\t\t\tconsole.log('关闭规则表' + i);\n\t\t\t\tthat.$refs.popupRule.close();\n\t\t\t\tawait that.sleep(2000);\n\t\t\t\tthat.shakeDice(dataArray[i].dice);\n\t\t\t\tawait that.sleep(5000);\n\t\t\t\tthat.$refs.popup.close();\n\t\t\t\tawait that.sleep(2000);\n\t\t\t\tlet blowEffectRes = await getBlowEffectList(data);\n\t\t\t\tthis.blowEffectList = blowEffectRes.data.data;\n\t\t\t\tconsole.log('打开结果表');\n\t\t\t\tthis.$refs.blowEffectTable.open();\n\t\t\t\tawait that.sleep(5000);\n\t\t\t\tconsole.log('关闭结果表' + i);\n\t\t\t\tthat.$refs.blowEffectTable.close();\n\t\t\t}\n\t\t\tsendMsg(\n\t\t\t\tJSON.stringify({\n\t\t\t\t\taction: 'takeAction',\n\t\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t\t})\n\t\t\t);\n\t\t},\n\t\tasync getBlowEffectList() {\n\t\t\tlet data = {\n\t\t\t\tverdictType: 10\n\t\t\t};\n\t\t\tlet blowEffectRes = await getBlowEffectList(data);\n\t\t\tthis.blowEffectList = blowEffectRes.data.data;\n\t\t\tthis.$refs.blowEffectTable.open();\n\t\t},\n\t\tasync refresh() {\n\t\t\tawait this.queryUsChessPiecesInfoFunc();\n\t\t\tawait this.queryPromptFunc();\n\t\t},\n\t\tasync endRoundFunc() {\n\t\t\tlet data = {\n\t\t\t\tid: this.verdictRecordId,\n\t\t\t\tuserId: this.user.id,\n\t\t\t\tchessRound: this.roundActive,\n\t\t\t\troundPeriod: this.stageActive + 1\n\t\t\t};\n\t\t\tawait endRound(data);\n\t\t\tsendMsg(\n\t\t\t\tJSON.stringify({\n\t\t\t\t\taction: 'endRound',\n\t\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t\t})\n\t\t\t);\n\t\t},\n\t\tasync judge() {\n\t\t\tthis.judgeTableShowInfo = {\n\t\t\t\ttype: 'judge',\n\t\t\t\tverdictRecordId: this.verdictRecordId,\n\t\t\t\tcampId: this.campId,\n\t\t\t\tchessRound: this.roundActive,\n\t\t\t\troundPeriod: this.stageActive + 1\n\t\t\t};\n\t\t\tthis.$refs.judgeTable.open();\n\t\t\t// let data = {\n\t\t\t// \tverdictRecordId: this.verdictRecordId,\n\t\t\t// \tchessRound: this.roundActive,\n\t\t\t// \troundPeriod: this.stageActive + 1\n\t\t\t// };\n\t\t\t// let res = await judge(data);\n\t\t\t// let resultData = res.data.data;\n\t\t\t// console.log('resultData: ', resultData.length);\n\t\t\t// if (resultData.length > 0) {\n\t\t\t// \tsendMsg(\n\t\t\t// \t\tJSON.stringify({\n\t\t\t// \t\t\taction: 'judge',\n\t\t\t// \t\t\tverdictRecordId: this.verdictRecordId,\n\t\t\t// \t\t\tdata: resultData\n\t\t\t// \t\t})\n\t\t\t// \t);\n\t\t\t// } else {\n\t\t\t// \tsendMsg(\n\t\t\t// \t\tJSON.stringify({\n\t\t\t// \t\t\taction: 'takeAction',\n\t\t\t// \t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t// \t\t})\n\t\t\t// \t);\n\t\t\t// }\n\t\t},\n\t\tasync submitScore(scoreList) {\n\t\t\tfor (let i in scoreList) {\n\t\t\t\tscoreList[i].campId = this.campListItem.campId;\n\t\t\t\tscoreList[i].campName = this.campListItem.campName;\n\t\t\t\tscoreList[i].userId = this.campListItem.userId;\n\t\t\t\tscoreList[i].userName = this.campListItem.userName;\n\t\t\t\tscoreList[i].verdictRecordId = this.campListItem.verdictRecordId;\n\t\t\t\tscoreList[i].chessRound = this.campListItem.chessRound;\n\t\t\t}\n\t\t\tlet res = await submitScore(scoreList);\n\t\t\tif (res.data.code == 200) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '提交成功',\n\t\t\t\t\ticon: 'none',\n\t\t\t\t\tduration: 1500\n\t\t\t\t});\n\t\t\t\tthis.$refs.scoreTable.close();\n\t\t\t\tthis.scoreList = [];\n\t\t\t} else {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '提交失败！',\n\t\t\t\t\ticon: 'error',\n\t\t\t\t\tduration: 1500\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tshowActionDescFunc() {\n\t\t\tif (!this.showActionDescFlag) {\n\t\t\t\tthis.$refs.showActionDesc.open();\n\t\t\t} else {\n\t\t\t\tthis.$refs.showActionDesc.close();\n\t\t\t}\n\t\t\tthis.showActionDescFlag = !this.showActionDescFlag;\n\t\t},\n\t\tjudgeComplete() {\n\t\t\tsendMsg(\n\t\t\t\tJSON.stringify({\n\t\t\t\t\taction: 'takeAction',\n\t\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t\t})\n\t\t\t);\n\t\t\tsendMsg(\n\t\t\t\tJSON.stringify({\n\t\t\t\t\taction: 'clearRoad',\n\t\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t\t})\n\t\t\t);\n\t\t},\n\t\tnextStage() {\n\t\t\tnextStage(this.verdictRecordId).then((res) => {\n\t\t\t\tconsole.log('res: ',res);\n\t\t\t\tsendMsg(\n\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\taction: 'takeAction',\n\t\t\t\t\t\tverdictRecordId: this.verdictRecordId\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\tthis.nextStageFlag = false;\n\t\t\t});\n\t\t}\n\t}\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.xinyi-content {\n\tbackground-image: url('@/static/image/login/bg.jpg');\n}\n#map {\n\twidth: 100vw;\n\theight: 100vh;\n\tz-index: 998;\n}\n.middleBtn {\n\tposition: fixed;\n\tbottom: 100px;\n\twidth: 100px;\n\tleft: calc(50vw - 50px);\n\tz-index: 1000;\n\n\t.btnView {\n\t\tbackground-color: #2979ff;\n\t\tcolor: #ffffff;\n\t\ttext-align: center;\n\t\tmargin-top: 2px;\n\t\talign-items: center;\n\t\tpadding: 10px 5px 10px 5px;\n\t}\n}\n.rightBtn {\n\tposition: fixed;\n\ttop: 200px;\n\tright: 0px;\n\tz-index: 1000;\n\ttext-align: center;\n\n\t.btnView {\n\t\twriting-mode: vertical-rl;\n\t\tbackground-color: #2979ff;\n\t\tcolor: #ffffff;\n\t\ttext-align: center;\n\t\tmargin-top: 2px;\n\t\talign-items: center;\n\t\tpadding: 10px 5px 10px 5px;\n\t\twidth: 20px;\n\t}\n}\n.top__view {\n\tposition: fixed;\n\tdisplay: flex;\n\twidth: 96vw;\n\theight: 10vh;\n\tz-index: 999;\n\talign-items: center;\n\t// background: rgba(255, 255, 255, 0.5);\n\n\t.dice-toolbar__veiw {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\twidth: 80rpx;\n\t\tmargin-left: 10rpx;\n\t\tbutton {\n\t\t\tmargin-left: 10rpx;\n\t\t}\n\t}\n\n\t.avatar-view {\n\t\twidth: 100px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tmargin-left: 10rpx;\n\t}\n}\n.foot-view {\n\tposition: fixed;\n\tbottom: 0;\n\tdisplay: flex;\n\twidth: 96vw;\n\theight: 10vh;\n\tz-index: 1000;\n\t// margin-top: 20px;\n}\n.newcontextmenu {\n\tposition: absolute;\n\twidth: 100px;\n\tz-index: 1000;\n\tbackground-color: #10292f;\n}\n\n.score-btn-view {\n\ttext-align: center;\n\tbackground-color: #10292f;\n\t// padding: 10px 10px 10px 10px;\n\tcursor: pointer;\n\tborder-radius: 10px;\n\n\t.uv-text {\n\t\twidth: 100%;\n\t\tpadding: 10px 10px 10px 10px;\n\t}\n\n\t.chess-view {\n\t\twidth: 100%;\n\t\ttext-align: left;\n\t\tpadding: 10px 10px 10px 10px;\n\t\tcolor: #ffffff;\n\t}\n}\n</style>\n","import mod from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index-v2.vue?vue&type=style&index=0&id=4e433f65&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index-v2.vue?vue&type=style&index=0&id=4e433f65&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1730963221369\n      var cssReload = require(\"D:/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}